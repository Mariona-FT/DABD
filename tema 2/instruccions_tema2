Instruccions classe teoria tema 2:

Problema: Màquines de la factoria, I
Una factoria immensa té una elevada quantitat de màquines. De
cadascuna tenim el número amb que està inventariada i el seu
fabricant.
Periòdicament, un tècnic supervisa individualment cada màquina.
Cada tècnic, de qui coneixem el DNI i les seves dades personals,
coneix la distribució de la seva setmana laboral en franjes horàries
amb la indicació de quina màquina ha de supervisar en cadascuna
d’aquestes franges.

Classes-taules:

TÉCNICS 1.*____________________	0.* MÀQUINES---construides-----FABRICANT
- DNI			|	- id_maquina			-nom
- DadesPersonals	|	
			|
		SUPERVISIÓ
		-franja
		
INCORRECTE: només pot haver-hi UNA supervisió entre tecnics i màquines en tota la vida
+la franja es una llista limitada de hores - ha de ser una classe sola

SUPERVISIÓ 1.*____________________0.* MÀQUINES---construides-----FABRICANT
- franja		|	- id_maquina			-nom
			|	
			|
			TÉCNIC
			-DNI
			-DadesPersonals

Creació de taules: (sense fabricant)

maq- maquina
evsup-supervisio
tec-tecnic

CREATE TABLE maq
	(ninv int NOT NULL, fab text, PRIMARY KEY(ninv));
	
CREATE TABLE evsup
	(fh text NOT NULL, PRIMARY KEY(fh));
	
CREATE TABLE tec (
	dni int NOT NULL, dp text,
	fh text NOT NULL,
	ninv int NOT NULL,
	FOREIGN KEY (fh) REFERENCES evsup
		ON UPDATE CASCADE,
	FOREIGN KEY (ninv) REFERENCES maq
		ON UPDATE CASCADE,
	PRIMARY KEY(fh,ninv), UNIQUE(fh,dni));


Creació un altre exemple:

Estructura:

CIUTATS 1_____1.* CLIENTS
-codi 		 -dni
-nom		 -nom	
		

Creació de taules:
		
CREATE TABLE CIUTATS (
	codi INT PRIMARY KEY,
	num VARCHAR(90) NOT NULL
	);

CREATE TABLE CLIENTS (
	dni TEXT PRIMARY KEY,
	nom VARCHAR(90) NOT NULL
	codi_ciutats INT REFERENCE CIUTATS.codi
	);
	
relació entre taules --> codi_ciutats INT REFERENCE CIUTATS.codi
 les relacions sempre han de relacionar a una clau primaria d'una altre classe
 

Hi han CIUTATS mateix nom en DIFERENTS PAISOS

Re Estructura:
PAISOS 1 ___1.*	CIUTATS 1_____1.* CLIENTS
-nom 		 -dni
		 -nom	
		

Creació de taules:
CREATE TABLE PAISOS (
	codi INT PRIMARY KEY,
	num VARCHAR(90) NOT NULL
	);
			
CREATE TABLE CIUTATS (
	codi INT PRIMARY KEY,
	num VARCHAR(90) NOT NULL
	);

CREATE TABLE CLIENTS (
	dni TEXT PRIMARY KEY,
	nom VARCHAR(90) NOT NULL
	codi_ciutats INT REFERENCE CIUTATS.codi
	);
	
	
Re Estructura:

CREATE TABLE ciutat(
	nom ciutat VARCHAR(50) NOT NULL,
	nom pais VARCHAR(20) NOT NULL,
	PRIMARY KEY(nom ciutat, nom pais));

CREATE TABLE client (
codi CHAR(8) NOT NULL PRIMARY KEY,
	nom ciutat VARCHAR(50) NOT NULL,
	nom pais VARCHAR(20) NOT NULL,
	FOREIGN KEY (nom ciutat, nom pais) REFERENCES ciutat);

